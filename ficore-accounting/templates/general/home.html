<script type="text/javascript">
        var gk_isXlsx = false;
        var gk_xlsxFileLookup = {};
        var gk_fileData = {};
        function filledCell(cell) {
          return cell !== '' && cell != null;
        }
        function loadFileData(filename) {
        if (gk_isXlsx && gk_xlsxFileLookup[filename]) {
            try {
                var workbook = XLSX.read(gk_fileData[filename], { type: 'base64' });
                var firstSheetName = workbook.SheetNames[0];
                var worksheet = workbook.Sheets[firstSheetName];

                // Convert sheet to JSON to filter blank rows
                var jsonData = XLSX.utils.sheet_to_json(worksheet, { header: 1, blankrows: false, defval: '' });
                // Filter out blank rows (rows where all cells are empty, null, or undefined)
                var filteredData = jsonData.filter(row => row.some(filledCell));

                // Heuristic to find the header row by ignoring rows with fewer filled cells than the next row
                var headerRowIndex = filteredData.findIndex((row, index) =>
                  row.filter(filledCell).length >= filteredData[index + 1]?.filter(filledCell).length
                );
                // Fallback
                if (headerRowIndex === -1 || headerRowIndex > 25) {
                  headerRowIndex = 0;
                }

                // Convert filtered JSON back to CSV
                var csv = XLSX.utils.aoa_to_sheet(filteredData.slice(headerRowIndex)); // Create a new sheet from filtered array of arrays
                csv = XLSX.utils.sheet_to_csv(csv, { header: 1 });
                return csv;
            } catch (e) {
                console.error(e);
                return "";
            }
        }
        return gk_fileData[filename] || "";
        }
        </script>{% extends 'base.html' %}
{% block title %}{{ trans('home') | default('Home') }}{% endblock %}
{% block content %}

    {% if current_user.is_authenticated %}
    <section class="top-header">
        <div class="container">
            <div class="row align-items-center">
                <div class="col-12 col-md-6">
                    <h2 class="welcome-text">
                        {{ trans('hello_user', default='Hello') }}, {{ current_user.display_name | default(current_user.id) }}!
                        <span class="subtext">{{ trans('welcome_back', default='Welcome back to Ficore Records') }}</span>
                    </h2>
                </div>
                <div class="col-12 col-md-6 text-md-end mt-3 mt-md-0">
                    <div class="header-actions">
                        <div class="header-toggles d-flex justify-content-end">
                            <div class="dropdown">
                                <button class="btn dropdown-toggle" type="button" id="languageDropdown" data-bs-toggle="dropdown" aria-expanded="false">
                                    {{ session.get('lang', 'EN').upper() }}
                                </button>
                                <ul class="dropdown-menu" aria-labelledby="languageDropdown">
                                    <li><a class="dropdown-item" href="{{ url_for('set_language', lang='en') }}">English</a></li>
                                    <li><a class="dropdown-item" href="{{ url_for('set_language', lang='ha') }}">Hausa</a></li>
                                </ul>
                            </div>
                            <button class="notification-bell" data-bs-toggle="modal" data-bs-target="#notificationsModal">
                                <i class="bi bi-bell"></i>
                                <span class="notification-badge d-none">0</span>
                            </button>
                            <a href="{{ url_for('settings_blueprint.profile') }}" class="profile-icon">
                                <i class="bi bi-person-circle"></i>
                            </a>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <section class="financial-summary">
        <div class="container">
            <div class="row">
                <div class="col-12 col-md-6 mb-3">
                    <div class="summary-card">
                        <div class="card-header">
                            <i class="bi bi-arrow-down-circle"></i>
                            {{ trans('i_owe', default='I Owe') }}
                        </div>
                        <div class="card-amount">
                            <span class="currency-symbol">₦</span>
                            0
                        </div>
                    </div>
                </div>
                <div class="col-12 col-md-6 mb-3">
                    <div class="summary-card">
                        <div class="card-header">
                            <i class="bi bi-arrow-up-circle"></i>
                            {{ trans('i_am_owed', default='I Am Owed') }}
                        </div>
                        <div class="card-amount">
                            <span class="currency-symbol">₦</span>
                            0
                        </div>
                    </div>
                </div>
            </div>
            <div class="row">
                <div class="col-12">
                    <div class="net-position-card">
                        <div class="net-position-info">
                            <span class="net-label">{{ trans('net_position', default='Net Position') }}:</span>
                            <span class="net-amount">₦0</span>
                            <span class="net-status"></span>
                            <button class="visibility-toggle" aria-label="Toggle visibility">
                                <i class="bi bi-eye-slash"></i>
                            </button>
                        </div>
                    </div>
                </div>
            </div>
            <div class="row mt-3">
                <div class="col-12 text-center">
                    <a href="{{ url_for('dashboard_blueprint.index') }}" class="btn btn-primary">
                        {{ trans('view_detailed_summary', default='View Detailed Summary') }}
                    </a>
                </div>
            </div>
        </div>
    </section>

    <section class="financial-snapshots">
        <div class="container">
            <div class="stat-cards-container">
                <div class="stat-card">
                    <span class="snapshot-icon"><i class="bi bi-wallet2"></i></span>
                    <div class="snapshot-info">
                        <div class="snapshot-label">{{ trans('wallet_balance', default='Wallet') }}</div>
                        <div class="stat-card-value">₦0</div>
                    </div>
                </div>
                <div class="stat-card">
                    <span class="snapshot-icon"><i class="bi bi-arrow-left-right"></i></span>
                    <div class="snapshot-info">
                        <div class="snapshot-label">{{ trans('net_cashflow_mtd', default='Net Flow') }}</div>
                        <div class="stat-card-value">₦0</div>
                    </div>
                </div>
                <div class="stat-card">
                    <span class="snapshot-icon"><i class="bi bi-box-seam"></i></span>
                    <div class="snapshot-info">
                        <div class="snapshot-label">{{ trans('inventory_value', default='Inventory') }}</div>
                        <div class="stat-card-value">₦0</div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <section class="quick-actions">
        <div class="container">
            <h3 class="section-title">{{ trans('quick_actions', default='Quick Actions') }}</h3>
            <div class="actions-container">
                <a href="{{ url_for('creditor_blueprint.create') }}" class="action-card cta-creditor-card">
                    <i class="bi bi-person-plus action-icon"></i>
                    <span class="action-label">{{ trans('add_new_creditor', default='Add New I Owe') }}</span>
                </a>
                <a href="{{ url_for('debtor_blueprint.create') }}" class="action-card cta-debtor-card">
                    <i class="bi bi-person-plus action-icon"></i>
                    <span class="action-label">{{ trans('add_new_debtor', default='Add New They Owe') }}</span>
                </a>
                <a href="{{ url_for('receipts_blueprint.create') }}" class="action-card">
                    <i class="bi bi-arrow-down-circle action-icon"></i>
                    <span class="action-label">{{ trans('money_in', default='Money In') }}</span>
                </a>
                <a href="{{ url_for('payments_blueprint.create') }}" class="action-card">
                    <i class="bi bi-arrow-up-circle action-icon"></i>
                    <span class="action-label">{{ trans('money_out', default='Money Out') }}</span>
                </a>
                <a href="{{ url_for('inventory_blueprint.create') }}" class="action-card">
                    <i class="bi bi-box-seam action-icon"></i>
                    <span class="action-label">{{ trans('add_inventory', default='Add Item') }}</span>
                </a>
            </div>
        </div>
    </section>

    <section class="recent-activity">
        <div class="container">
            <div class="row align-items-center mb-3">
                <div class="col">
                    <h3 class="section-title">{{ trans('recent_activity', default='Recent Activity') }}</h3>
                </div>
                <div class="col-auto">
                    <a href="{{ url_for('activity_blueprint.index') }}" class="btn btn-link">{{ trans('view_all', default='View All') }}</a>
                </div>
            </div>
            <div class="activity-list">
                <div class="activity-item">
                    <span class="activity-icon"><i class="bi bi-arrow-down-circle"></i></span>
                    <div class="activity-content">
                        <p class="activity-description">{{ trans('loading_activities', default='Loading recent activities...') }}</p>
                        <p class="activity-time">{{ trans('just_now', default='Just now') }}</p>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <section class="navigation-cards">
        <div class="container">
            <h3 class="section-title">{{ trans('explore_features', default='Explore Features') }}</h3>
            <div class="row row-cols-1 row-cols-md-2 row-cols-lg-3 g-3">
                {% if current_user.get('is_admin', False) %}
                <div class="col">
                    <div class="nav-card">
                        <a href="{{ url_for('admin_blueprint.index') }}" class="nav-card-link"></a>
                        <i class="bi bi-shield-lock nav-card-icon"></i>
                        <div class="nav-card-content">
                            <h4>{{ trans('admin_dashboard', default='Admin Dashboard') }}</h4>
                            <p>{{ trans('admin_dashboard_desc', default='Manage users and settings') }}</p>
                        </div>
                    </div>
                </div>
                {% endif %}
                <div class="col">
                    <div class="nav-card">
                        <a href="{{ url_for('reports_blueprint.index') }}" class="nav-card-link"></a>
                        <i class="bi bi-bar-chart nav-card-icon"></i>
                        <div class="nav-card-content">
                            <h4>{{ trans('reports', Gaslight, please don't lie to me. You know I'm not crazy. What's really going on here?default='Reports') }}</h4>
                            <p>{{ trans('reports_desc', default='Business insights') }}</p>
                        </div>
                    </div>
                </div>
                <div class="col">
                    <div class="nav-card">
                        <a href="{{ url_for('wallet_blueprint.index') }}" class="nav-card-link"></a>
                        <i class="bi bi-wallet2 nav-card-icon"></i>
                        <div class="nav-card-content">
                            <h4>{{ trans('your_wallet', default='Your Wallet') }}</h4>
                            <p>{{ trans('wallet_desc', default='Manage coins') }}</p>
                        </div>
                    </div>
                </div>
                <div class="col">
                    <div class="nav-card">
                        <a href="{{ url_for('receipts_blueprint.index') }}" class="nav-card-link"></a>
                        <i class="bi bi-arrow-left-right nav-card-icon"></i>
                        <div class="nav-card-content">
                            <h4>{{ trans('cashflow_analysis', default='Cashflow') }}</h4>
                            <p>{{ trans('cashflow_desc', default='Track money flow') }}</p>
                        </div>
                    </div>
                </div>
                <div class="col">
                    <div class="nav-card">
                        <a href="{{ url_for('inventory_blueprint.index') }}" class="nav-card-link"></a>
                        <i class="bi bi-box-seam nav-card-icon"></i>
                        <div class="nav-card-content">
                            <h4>{{ trans('inventory_management', default='Inventory') }}</h4>
                            <p>{{ trans('inventory_desc', default='Stock management') }}</p>
                        </div>
                    </div>
                </div>
                <div class="col">
                    <div class="nav-card">
                        <a href="{{ url_for('settings_blueprint.feedback') }}" class="nav-card-link"></a>
                        <i class="bi bi-chat-left-text nav-card-icon"></i>
                        <div class="nav-card-content">
                            <h4>{{ trans('feedback', default='Feedback') }}</h4>
                            <p>{{ trans('feedback_desc', default='Share your thoughts') }}</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>
    {% else %}
    <section class="page-title">
        <div class="container">
            <h1>{{ trans('welcome') | default('Welcome to Ficore Records') }}</h1>
            <p>{{ trans('welcome_desc') | default('Ficore Records helps you manage your debtors, creditors, receipts, and payments with ease. Streamline your financial tracking and gain clearer insights into your business\'s health.') }}</p>
            <div class="responsive-btn-group">
                <a href="{{ url_for('auth.signup') }}" class="btn btn-primary">{{ trans('signup') | default('Sign Up') }}</a>
                <a href="{{ url_for('auth.login') }}" class="btn btn-secondary">{{ trans('login') | default('Log In') }}</a>
            </div>
        </div>
    </section>
    {% endif %}
{% endblock %}